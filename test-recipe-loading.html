<!DOCTYPE html>
<html>
<head>
    <title>Test Recipe Loading</title>
</head>
<body>
    <h1>AI Recipe Loading Test</h1>
    <button id="test-recipe-load">Test Recipe Loading</button>
    <div id="test-results"></div>

    <!-- Firebase Configuration -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-functions-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDmvUqgMlnaQFiyqlo50D66fX0Bwav3j1k",
            authDomain: "brewmetrics-xyz-app-e8d51.firebaseapp.com",
            projectId: "brewmetrics-xyz-app-e8d51",
            storageBucket: "brewmetrics-xyz-app-e8d51.firebasestorage.app",
            messagingSenderId: "391623246374",
            appId: "1:391623246374:web:3b8e39db5fff674befdce7",
            measurementId: "G-MHT3H2ZVRY"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const functions = firebase.functions();
    </script>

    <!-- AI Brewmaster -->
    <script src="utils.js"></script>
    <script src="ai-brewmaster.js"></script>

    <script>
        document.getElementById('test-recipe-load').addEventListener('click', async () => {
            const results = document.getElementById('test-results');
            results.innerHTML = 'Testing recipe loading...';

            try {
                // Create a test recipe
                const testRecipe = {
                    name: 'Test IPA',
                    type: 'All Grain',
                    batchSize: 5.0,
                    efficiency: 72.0,
                    boilTime: 60,
                    style: 'American IPA',
                    fermentables: [
                        { name: 'Pale 2-Row', amount: 10, unit: 'lb', ppg: 37, lovibond: 2 }
                    ],
                    hops: [
                        { name: 'Cascade', amount: 1, unit: 'oz', alpha: 5.5, time: 60, use: 'Boil' }
                    ],
                    yeast: [
                        { name: 'US-05', type: 'Ale', form: 'Dry', amount: 1, unit: 'pkg', attenuation: 81 }
                    ],
                    targetOG: 1.060,
                    targetFG: 1.012,
                    targetABV: 6.2,
                    targetIBU: 35
                };

                // Test the loading function
                const success = await window.AIBrewmaster.loadRecipeIntoDesigner(testRecipe);
                
                results.innerHTML = `
                    <h3>Test Results:</h3>
                    <p><strong>Success:</strong> ${success}</p>
                    <p><strong>Recipe Designer Available:</strong> ${!!window.recipeDesigner}</p>
                    <p><strong>Form Fields Found:</strong></p>
                    <ul>
                        <li>Recipe Name: ${!!document.getElementById('recipe-name')}</li>
                        <li>Batch Volume: ${!!document.getElementById('batch-vol')}</li>
                        <li>Efficiency: ${!!document.getElementById('efficiency')}</li>
                        <li>Fermentables List: ${!!document.getElementById('fermentables-list')}</li>
                        <li>Hops List: ${!!document.getElementById('hops-list')}</li>
                    </ul>
                `;

            } catch (error) {
                results.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
                console.error('Test error:', error);
            }
        });
    </script>
</body>
</html>

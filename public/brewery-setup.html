<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brewery Setup - BrewMetrics</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="enhanced-ui.css" rel="stylesheet">
    <link href="brewery-theme.css" rel="stylesheet">
    <style>
        .setup-wizard { max-width: 1200px; margin: 0 auto; }
        .wizard-progress { background: white; border-radius: 12px; padding: 20px; margin: 20px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .progress-bar { width: 100%; height: 8px; background: #e9ecef; border-radius: 4px; overflow: hidden; margin: 15px 0; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--primary-color), #ff8c00); transition: width 0.3s; }
        .wizard-steps { display: flex; justify-content: space-between; margin: 20px 0; }
        .wizard-step { display: flex; flex-direction: column; align-items: center; flex: 1; position: relative; }
        .step-circle { width: 50px; height: 50px; border-radius: 50%; background: #e9ecef; display: flex; align-items: center; justify-content: center; font-weight: bold; transition: all 0.3s; cursor: pointer; }
        .step-circle.active { background: var(--primary-color); color: white; transform: scale(1.1); }
        .step-circle.completed { background: #28a745; color: white; }
        .step-label { margin-top: 8px; font-size: 0.9em; text-align: center; color: #666; }
        .step-circle.active + .step-label { color: var(--primary-color); font-weight: bold; }
        .step-connector { position: absolute; top: 25px; left: 50%; width: 100%; height: 2px; background: #e9ecef; z-index: -1; }
        .step-connector.completed { background: #28a745; }
        .setup-section { display: none; background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin: 20px 0; overflow: hidden; }
        .setup-section.active { display: block; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .section-header { background: linear-gradient(135deg, var(--primary-color), #ff8c00); color: white; padding: 30px; text-align: center; }
        .section-content { padding: 40px; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0; }
        .form-group { position: relative; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #333; }
        .form-group input, .form-group select { width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px; transition: all 0.3s; }
        .form-group input:focus, .form-group select:focus { border-color: var(--primary-color); outline: none; box-shadow: 0 0 0 3px rgba(230, 126, 34, 0.1); }
        .equipment-section { margin: 30px 0; }
        .equipment-category { margin: 40px 0; }
        .category-title { display: flex; align-items: center; margin-bottom: 20px; font-size: 1.3em; font-weight: bold; color: #333; }
        .category-icon { width: 40px; height: 40px; background: var(--primary-color); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; margin-right: 15px; }
        .equipment-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 20px 0; }
        .equipment-card { border: 2px solid #e9ecef; border-radius: 12px; padding: 25px; cursor: pointer; transition: all 0.3s; position: relative; overflow: hidden; }
        .equipment-card::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent); transition: left 0.5s; }
        .equipment-card:hover::before { left: 100%; }
        .equipment-card:hover { border-color: var(--primary-color); transform: translateY(-5px); box-shadow: 0 8px 25px rgba(0,0,0,0.15); }
        .equipment-card.selected { border-color: var(--primary-color); background: linear-gradient(135deg, #fff, #f8f9fa); box-shadow: 0 8px 25px rgba(230, 126, 34, 0.2); }
        .card-header { display: flex; align-items: center; margin-bottom: 15px; }
        .card-icon { width: 50px; height: 50px; background: linear-gradient(135deg, var(--primary-color), #ff8c00); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; margin-right: 15px; font-size: 1.5em; }
        .card-title { font-size: 1.2em; font-weight: bold; color: #333; }
        .card-description { color: #666; line-height: 1.5; }
        .equipment-specs { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0; }
        .spec-card { background: #f8f9fa; border-radius: 12px; padding: 20px; border-left: 4px solid var(--primary-color); }
        .spec-label { font-weight: bold; color: #333; margin-bottom: 5px; }
        .spec-value { color: #666; }
        .efficiency-display { background: linear-gradient(135deg, #28a745, #20c997); color: white; border-radius: 12px; padding: 20px; text-align: center; margin: 20px 0; }
        .efficiency-value { font-size: 2.5em; font-weight: bold; }
        .efficiency-breakdown { font-size: 0.9em; opacity: 0.9; margin-top: 10px; }
        .photo-upload-area { border: 3px dashed #ddd; border-radius: 12px; padding: 60px; text-align: center; cursor: pointer; transition: all 0.3s; background: linear-gradient(135deg, #f8f9fa, #fff); }
        .photo-upload-area:hover { border-color: var(--primary-color); background: linear-gradient(135deg, #fff, #f8f9fa); }
        .photo-upload-area.dragover { border-color: var(--primary-color); background: rgba(230, 126, 34, 0.1); }
        .upload-icon { font-size: 4em; color: var(--primary-color); margin-bottom: 20px; }
        .batch-photos { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; margin: 30px 0; }
        .photo-item { position: relative; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1); transition: transform 0.3s; }
        .photo-item:hover { transform: scale(1.05); }
        .photo-item img { width: 100%; height: 140px; object-fit: cover; }
        .photo-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); opacity: 0; transition: opacity 0.3s; display: flex; align-items: center; justify-content: center; }
        .photo-item:hover .photo-overlay { opacity: 1; }
        .photo-remove { background: #dc3545; color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 1.2em; }
        .wizard-actions { display: flex; justify-content: space-between; align-items: center; padding: 30px 40px; background: #f8f9fa; border-top: 1px solid #e9ecef; }
        .btn-wizard { padding: 12px 30px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .btn-primary { background: linear-gradient(135deg, var(--primary-color), #ff8c00); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(230, 126, 34, 0.3); }
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #5a6268; }
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 30px 0; }
        .summary-card { background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); border-left: 4px solid var(--primary-color); }
        .summary-title { font-weight: bold; color: #333; margin-bottom: 10px; }
        .summary-value { font-size: 1.5em; color: var(--primary-color); font-weight: bold; }
        .completion-icon { font-size: 6em; color: #28a745; margin-bottom: 20px; }
        .success-message { text-align: center; padding: 40px; }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">
            <i class="fas fa-beer"></i>
            <span>BrewMetrics</span>
        </div>
        <div class="nav-links">
            <a href="dashboard.html"><i class="fas fa-chart-line"></i> Dashboard</a>
            <a href="brewery-setup.html" class="active"><i class="fas fa-cogs"></i> Setup</a>
            <a href="inventory.html"><i class="fas fa-boxes"></i> Inventory</a>
            <a href="recipe-designer.html"><i class="fas fa-flask"></i> Recipes</a>
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <h1><i class="fas fa-cogs"></i> Brewery Setup</h1>
            <p>Configure your brewery equipment and batch photos for optimized AI recipe generation</p>
        </div>

        <div class="setup-wizard">
            <div class="wizard-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 25%;"></div>
                </div>
                <div class="wizard-steps">
                    <div class="wizard-step">
                        <div class="step-circle active" data-step="1">1</div>
                        <div class="step-label">Basic Info</div>
                        <div class="step-connector"></div>
                    </div>
                    <div class="wizard-step">
                        <div class="step-circle" data-step="2">2</div>
                        <div class="step-label">Equipment</div>
                        <div class="step-connector"></div>
                    </div>
                    <div class="wizard-step">
                        <div class="step-circle" data-step="3">3</div>
                        <div class="step-label">Brewery Logo</div>
                        <div class="step-connector"></div>
                    </div>
                    <div class="wizard-step">
                        <div class="step-circle" data-step="4">4</div>
                        <div class="step-label">Complete</div>
                    </div>
                </div>
            </div>

            <!-- Step 1: Basic Info -->
            <div class="setup-section active" id="step-1">
                <div class="section-header">
                    <h2><i class="fas fa-info-circle"></i> Brewery Information</h2>
                    <p>Tell us about your brewery to customize your experience</p>
                </div>
                <div class="section-content">
                    <div class="form-grid">
                        <div class="form-group">
                            <label><i class="fas fa-beer"></i> Brewery Name</label>
                            <input type="text" id="brewery-name" placeholder="Enter your brewery name">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-industry"></i> Brewery Type</label>
                            <select id="brewery-type">
                                <option value="microbrewery">Microbrewery</option>
                                <option value="brewpub">Brewpub</option>
                                <option value="regional">Regional Brewery</option>
                                <option value="contract">Contract Brewery</option>
                                <option value="homebrew">Homebrew Operation</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-chart-bar"></i> Annual Production (BBL)</label>
                            <input type="number" id="annual-production" placeholder="e.g., 500">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-list"></i> Primary Beer Styles</label>
                            <input type="text" id="primary-styles" placeholder="e.g., IPA, Stout, Lager">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-map-marker-alt"></i> Location</label>
                            <input type="text" id="brewery-location" placeholder="City, State">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-calendar"></i> Founded Year</label>
                            <input type="number" id="founded-year" placeholder="e.g., 2020" min="1900" max="2024">
                        </div>
                    </div>
                </div>
                <div class="wizard-actions">
                    <div></div>
                    <button class="btn-wizard btn-primary" onclick="nextStep(2)">
                        Next: Equipment Setup <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- Step 2: Equipment Setup -->
            <div class="setup-section" id="step-2">
                <div class="section-header">
                    <h2><i class="fas fa-industry"></i> Equipment Configuration</h2>
                    <p>Configure your brewing equipment for optimized recipe generation</p>
                </div>
                <div class="section-content">
                    <div class="equipment-category">
                        <div class="category-title">
                            <div class="category-icon"><i class="fas fa-fire"></i></div>
                            Mash Tun Configuration
                        </div>
                        
                        <div class="equipment-grid">
                            <div class="equipment-card" data-equipment="direct-fire">
                                <div class="card-header">
                                    <div class="card-icon"><i class="fas fa-fire"></i></div>
                                    <div class="card-title">Direct Fire</div>
                                </div>
                                <div class="card-description">Gas or propane heated mash tun with direct flame heating</div>
                            </div>
                            <div class="equipment-card" data-equipment="steam-jacket">
                                <div class="card-header">
                                    <div class="card-icon"><i class="fas fa-thermometer-half"></i></div>
                                    <div class="card-title">Steam Jacket</div>
                                </div>
                                <div class="card-description">Steam heated vessel with even temperature distribution</div>
                            </div>
                            <div class="equipment-card" data-equipment="electric">
                                <div class="card-header">
                                    <div class="card-icon"><i class="fas fa-bolt"></i></div>
                                    <div class="card-title">Electric</div>
                                </div>
                                <div class="card-description">Electric heating elements with precise temperature control</div>
                            </div>
                        </div>

                        <div class="equipment-specs">
                            <div class="spec-card">
                                <div class="spec-label">Brand</div>
                                <select id="mash-brand" onchange="updateMashModels()" class="form-control">
                                    <option value="">Select Brand</option>
                                </select>
                            </div>
                            <div class="spec-card">
                                <div class="spec-label">Model</div>
                                <select id="mash-model" onchange="updateMashEfficiency()" class="form-control">
                                    <option value="">Select Model</option>
                                </select>
                            </div>
                            <div class="spec-card">
                                <div class="spec-label">Volume (BBL)</div>
                                <input type="number" id="mash-volume" step="0.1" placeholder="e.g., 7.0" class="form-control">
                            </div>
                        </div>
                        
                        <div class="efficiency-display" id="efficiency-display" style="display: none;">
                            <div class="efficiency-value" id="efficiency-value">75%</div>
                            <div>Calculated Efficiency</div>
                            <div class="efficiency-breakdown" id="efficiency-breakdown"></div>
                        </div>
                    </div>

                    <div class="equipment-category">
                        <div class="category-title">
                            <div class="category-icon"><i class="fas fa-wine-glass"></i></div>
                            Fermentation System
                        </div>
                        
                        <div class="equipment-grid">
                            <div class="equipment-card" data-equipment="conical">
                                <div class="card-header">
                                    <div class="card-icon"><i class="fas fa-wine-glass"></i></div>
                                    <div class="card-title">Conical Fermenters</div>
                                </div>
                                <div class="card-description">Stainless steel conical tanks with bottom collection</div>
                            </div>
                            <div class="equipment-card" data-equipment="horizontal">
                                <div class="card-header">
                                    <div class="card-icon"><i class="fas fa-grip-lines"></i></div>
                                    <div class="card-title">Horizontal Tanks</div>
                                </div>
                                <div class="card-description">Horizontal fermentation vessels for larger volumes</div>
                            </div>
                            <div class="equipment-card" data-equipment="open">
                                <div class="card-header">
                                    <div class="card-icon"><i class="fas fa-circle"></i></div>
                                    <div class="card-title">Open Fermenters</div>
                                </div>
                                <div class="card-description">Traditional open fermentation systems</div>
                            </div>
                        </div>

                        <div class="equipment-specs">
                            <div class="spec-card">
                                <div class="spec-label">Fermenter Brand</div>
                                <select id="fermenter-brand" onchange="updateFermenterModels()" class="form-control">
                                    <option value="">Select Brand</option>
                                </select>
                            </div>
                            <div class="spec-card">
                                <div class="spec-label">Fermenter Model</div>
                                <select id="fermenter-model" onchange="updateFermenterSpecs()" class="form-control">
                                    <option value="">Select Model</option>
                                </select>
                            </div>
                            <div class="spec-card">
                                <div class="spec-label">Fermenter Size (BBL)</div>
                                <input type="number" id="fermenter-size" step="0.1" placeholder="e.g., 15.0" class="form-control">
                            </div>
                            <div class="spec-card">
                                <div class="spec-label">Number of Fermenters</div>
                                <input type="number" id="fermenter-count" placeholder="e.g., 6" class="form-control">
                            </div>
                            <div class="spec-card">
                                <div class="spec-label">Temperature Control</div>
                                <select id="temp-control" class="form-control">
                                    <option value="glycol">Glycol Cooling</option>
                                    <option value="ambient">Ambient Control</option>
                                    <option value="immersion">Immersion Cooling</option>
                                </select>
                            </div>
                            <div class="spec-card">
                                <div class="spec-label">Pressure Capability</div>
                                <select id="pressure-capability" class="form-control">
                                    <option value="atmospheric">Atmospheric Only</option>
                                    <option value="low-pressure">Low Pressure (5-10 PSI)</option>
                                    <option value="high-pressure">High Pressure (15+ PSI)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="equipment-category">
                        <div class="category-title">
                            <div class="category-icon"><i class="fas fa-plus"></i></div>
                            Additional Equipment
                        </div>
                        
                        <div class="equipment-grid">
                            <div class="equipment-card" onclick="toggleEquipment('whirlpool')">
                                <div class="card-header">
                                    <div class="card-icon"><i class="fas fa-sync"></i></div>
                                    <div class="card-title">Whirlpool Tank</div>
                                </div>
                                <div class="card-description">Separate whirlpool vessel for hop utilization</div>
                                <input type="checkbox" id="has-whirlpool" style="display: none;">
                            </div>
                            <div class="equipment-card" onclick="toggleEquipment('hop-back')">
                                <div class="card-header">
                                    <div class="card-icon"><i class="fas fa-leaf"></i></div>
                                    <div class="card-title">Hop Back</div>
                                </div>
                                <div class="card-description">Hop back for additional aroma extraction</div>
                                <input type="checkbox" id="has-hop-back" style="display: none;">
                            </div>
                            <div class="equipment-card" onclick="toggleEquipment('centrifuge')">
                                <div class="card-header">
                                    <div class="card-icon"><i class="fas fa-circle-notch"></i></div>
                                    <div class="card-title">Centrifuge</div>
                                </div>
                                <div class="card-description">Centrifuge for beer clarification</div>
                                <input type="checkbox" id="has-centrifuge" style="display: none;">
                            </div>
                            <div class="equipment-card" onclick="toggleEquipment('filter')">
                                <div class="card-header">
                                    <div class="card-icon"><i class="fas fa-filter"></i></div>
                                    <div class="card-title">Filtration System</div>
                                </div>
                                <div class="card-description">Beer filtration for clarity and stability</div>
                                <input type="checkbox" id="has-filter" style="display: none;">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="wizard-actions">
                    <button class="btn-wizard btn-secondary" onclick="prevStep(1)">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button class="btn-wizard btn-primary" onclick="nextStep(3)">
                        Next: Batch Photos <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- Step 3: Brewery Logo -->
            <div class="setup-section" id="step-3">
                <div class="section-header">
                    <h2><i class="fas fa-image"></i> Brewery Logo</h2>
                    <p>Upload your brewery logo to personalize your customer surveys and reports</p>
                </div>
                <div class="section-content">
                    <div class="photo-upload-area" id="logo-upload-area" onclick="document.getElementById('logo-input').click()">
                        <div class="upload-icon">
                            <i class="fas fa-image"></i>
                        </div>
                        <h3>Upload Brewery Logo</h3>
                        <p>Click to select your logo or drag and drop file here</p>
                        <p style="color: #666; font-size: 0.9em;">Supported formats: JPG, PNG, SVG (Max 2MB) • Recommended: 400x400px</p>
                        <input type="file" id="logo-input" accept="image/*" style="display: none;">
                    </div>

                    <div class="logo-preview" id="logo-preview" style="display: none; text-align: center; margin: 30px 0;">
                        <img id="logo-image" style="max-width: 300px; max-height: 300px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                        <div style="margin-top: 15px;">
                            <button class="btn-wizard btn-secondary" onclick="removeLogo()">
                                <i class="fas fa-trash"></i> Remove Logo
                            </button>
                        </div>
                    </div>
                </div>
                <div class="wizard-actions">
                    <button class="btn-wizard btn-secondary" onclick="prevStep(2)">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button class="btn-wizard btn-primary" onclick="nextStep(4)">
                        Complete Setup <i class="fas fa-check"></i>
                    </button>
                </div>
            </div>

            <!-- Step 4: Complete -->
            <div class="setup-section" id="step-4">
                <div class="section-header">
                    <h2><i class="fas fa-check-circle"></i> Setup Complete!</h2>
                    <p>Your brewery configuration has been saved and optimized</p>
                </div>
                <div class="section-content">
                    <div class="success-message">
                        <div class="completion-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h3>Congratulations!</h3>
                        <p>Your brewery setup is complete. The AI Brewmaster will now use your equipment specifications to generate optimized recipes tailored to your system.</p>
                    </div>
                    
                    <div class="summary-grid" id="setup-summary">
                        <!-- Summary will be populated here -->
                    </div>
                </div>
                <div class="wizard-actions">
                    <button class="btn-wizard btn-secondary" onclick="window.location.href='dashboard.html'">
                        <i class="fas fa-chart-line"></i> Go to Dashboard
                    </button>
                    <button class="btn-wizard btn-primary" onclick="window.location.href='recipe-designer.html'">
                        <i class="fas fa-flask"></i> Create Your First Recipe
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script src="enhanced-ui.js"></script>
    <script src="demo-upgrade.js"></script>
    <script src="equipment-database.js"></script>
    <script src="brewery-setup.js"></script>
</body>
</html>